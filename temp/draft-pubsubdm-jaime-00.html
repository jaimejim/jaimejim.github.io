<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<title>draft-pubsubdm-jaime-00</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>

<style type="text/css">
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>


</head>

<body>

<h1 id="toc_0">Publish/Subscribe and Device Management</h1>

<p>Author: <a href="http://jaimejim.github.io">Jaime Jiménez</a></p>

<p><strong>TODO</strong></p>

<ul>
<li class="task-list-item"><input type="checkbox" checked> Move everything to github formatted markdown.
</li>
<li class="task-list-item"><input type="checkbox"> On <em>Terminology</em>, remove definitions that do not apply, rewrite and simplify.
</li>
<li class="task-list-item"><input type="checkbox"> Use <q>TBD</q> for small additions.
</li>
<li class="task-list-item"><input type="checkbox"> Use this for diagrams https://bramp.github.io/js-sequence-diagrams/
How do I use this script:
<script src="https://cdn.rawgit.com/knsv/mermaid/#version#/dist/mermaid.min.js"></script>
<script>mermaid.initialize({startOnLoad:true});</script>
</li>
</ul>

<p><strong>Table of Contents</strong>  </p>

<ul class="toc">
<li>
<a href="#toc_0">Publish/Subscribe and Device Management</a>
</li>
<li>
<a href="#toc_1">Abstract</a>
</li>
<li>
<a href="#toc_2">Introduction</a>
</li>
<li>
<a href="#toc_3">Terminology</a>
</li>
<li>
<a href="#toc_4">Architecture</a>
</li>
<li>
<a href="#toc_5">Device Management for MQTT</a>
</li>
<li>
<a href="#toc_6">Publish-Subscribe Broker for CoAP</a>
</li>
<li>
<a href="#toc_7">Examples</a>
</li>
<li>
<a href="#toc_8">Tests</a>
</li>
<li>
<a href="#toc_9">Acknowledgements</a>
</li>
<li>
<a href="#toc_10">References</a>
</li>
</ul>


<h1 id="toc_1">Abstract</h1>

<p>This document provides a summary of <a href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html">[MQTT]</a> and how it can be used for device management. Its target is to give an overview on how to perform well-known management functions with [MQTT] and similar publish/subscribe protocols. This document also contains links to the relevant state of the art in the Device Management area with MQTT, for example <a href="https://docs.internetofthings.ibmcloud.com/devices/device_mgmt/index.html">[MQTTDM]</a> or TBD and somewhat a comparison with existing <a href="https://www.ics.uci.edu/%7Efielding/pubs/dissertation/top.htm">[REST]</a> protocols like CoAP <a href="https://tools.ietf.org/html/rfc7252">[RFC7252]</a> as well as other alternatives such as the CoAP PubSub broker <a href="https://tools.ietf.org/html/draft-koster-core-coap-pubsub-04">[I-D.koster-core-coap-pubsub]</a>. </p>

<h1 id="toc_2">Introduction</h1>

<p>MQTT is a Client Server publish/subscribe messaging transport (or transfer) protocol. Networkwise it works over a TCP/IP connection. It also supports TLS <a href="https://tools.ietf.org/html/rfc5246">[RFC5246]</a> and WebSockets [RFC6455]. Non-reliable transports (i.e. UDP) are not supported. TCP is used to offer some form of QoS for applications. The pub/sub model is hub and spoke based, though implementations may provide clustered hubs to avoid a single point of failure(EMQTT). There is a separate extension (MQTT-SN), which is not part of the standard) which is adapted more to non-TCP/IP networks, such as UDP/Zigbee etc.</p>

<p>The protocol is very simple, with two main entities a Client and a Server (commonly referred as Broker). The Client is the one initiating the connection to the server, and can take the roles of publisher or subscriber. The Broker is a program or device that acts as an intermediary between Clients which publish and Clients which subscribe. The Broker can accept connections from clients, forward messages and process subscriptions and publications.</p>

<p>These pub/sub pattern is driven by what MQTT calls topics. Those topics are a simple text-form identifiers or labels for an applicaiton message for a communication. A Subscription is an operaiton on a topic, and is associated with a single Session. </p>

<p>MQTT allows filtering topics by means of wildcards, which is a way to perform search on a Broker that contains many topics. it will depend on how the topic name is structured that the wildcards will be more or less effective (i.e. if the topics are aleatorily named, then you cannot search on the Broker).</p>

<p>MQTT also has something called Session (not to confuse with TCP Session) which is a stateful interaction between a Client and a Server. Some Sessions last the same as the TCP session other span accross multiple consecutive network connecitons. </p>

<p>In order to perform a subscription, only the Broker address and the actual topic are required. For example:<br>
mqtt sub -t &#39;TOPIC&#39; -h &#39;test.mosquitto.org&#39; -v</p>

<p>For a publication, the actual content of the publication is obviously needed too. For example:<br>
mqtt pub -t &#39;TOPIC&#39; -h &#39;test.mosquitto.org&#39; -m &#39;PUBLICATION&#39;</p>

<p>The biggest strength of MQTT is its simplicity, which has helped to make it very common on prototypes and small deployments everywhere. Nevertheless this is also its biggest drawback. The lack of a standard way to define topics has created a wealth of non-easily-interoperable deployments. They required a good knowledge of the broker topics, namescpace and identifiers in order to enable interoperability. </p>

<p>The Device Management space suffers from that lack too, only recently there have been some efforts to standardize Device Management over MQTT (IBM Watson https://docs.internetofthings.ibmcloud.com/applications/mqtt.html, Eclipse Kura http://eclipse.github.io/kura/ref/mqtt-namespace.html), they focus on identifying a common Namespace and creating new identifiers for applicaitons working over MQTT (i.e. on Eclipse Kura they would be account<u>name, client</u>id, app<u>id, resource</u>id). </p>

<p>Due to its simplicity and popularity there is a wealth of MQTT implementations to choose from such as the Eclipse Mosquitto and Paho projects, the  Mosca broker and the mqttjs client.</p>

<p>MQTT is defined by OASIS as:</p>

<p><div class="mermaid"><br>
        graph LR<br>
            A--&gt;B<br>
            B--&gt;C<br>
            C--&gt;A<br>
            D--&gt;C<br>
    </div></p>

<blockquote>
<p>MQ Telemetry Transport (MQTT) is a lightweight broker-based publish/subscribe messaging protocol designed to be open, simple, lightweight and easy to implement.</p>
</blockquote>

<p>It is intended to run on low-bandwidth unreliable connections and for constrained devices. Some of its features are:</p>

<ul>
<li>Use of the publish/subscribe message pattern which provides one-to-many message distribution and decoupling of applications.</li>
<li>A messaging transport that is agnostic to the content of the payload.</li>
<li>The use of TCP/IP to provide basic network connectivity.</li>
<li>A small transport overhead and protocol exchanges minimised to reduce network traffic.</li>
<li>A mechanism to notify interested parties when an abnormal disconnection occurs.</li>
</ul>

<p>Some of its caveats are:</p>

<ul>
<li>Dependency on a Broker to handle the subscriptions and publications.</li>
<li>Lack of RESTful interaction means that state has to be kept by the Broker.</li>
<li>Lack of a consistent, standardised namespace for the topics implies that each implementor will create and use potentially different topic ids.</li>
</ul>

<h1 id="toc_3">Terminology</h1>

<p>MQTT uses common publish/subscribe terminology that we will use throughout this document. We have omitted some definition that did not apply in this context.</p>

<p><strong>Network Connection</strong>: In MQTT terminology it is a TCP/IP connection. There is also support TLS <a href="https://tools.ietf.org/html/rfc5246">[RFC5246]</a> and WebSockets [RFC6455]. Therefore UDP is not currently supported.</p>

<p><strong>Application Message</strong>: The data carried by the MQTT protocol across the network for the application. When Application Messages are transported by MQTT they have an associated Quality of Service and a Topic Name.</p>

<p><strong>Client</strong>: A program or device that uses MQTT. A Client always establishes the Network Connection to the Server. Can be publisher and subscriber. More at [MQTT].</p>

<p><strong>Broker</strong>: A program or device that acts as an intermediary between Clients which publish and Clients which subscribe.  It can accept connections from clients, forward messages and process subscriptions and publications. [MQTT] calls it Server.</p>

<p><strong>Subscription</strong>: A Subscription comprises a Topic Filter and a maximum QoS. A Subscription is associated with a single Session. A Session can contain more than one Subscription. Each Subscription within a session has a different Topic Filter.</p>

<p><strong>Topic Name</strong>: The label attached to an Application Message which is matched against the Subscriptions known to the Server. The Server sends a copy of the Application Message to each Client that has a matching Subscription.</p>

<p><strong>Topic Filter</strong>: An expression contained in a Subscription, to indicate an interest in one or more topics. A Topic Filter can include wildcard characters.</p>

<p><strong>Session</strong>: A stateful interaction between a Client and a Server. Some Sessions last only as long as the Network Connection, others can span multiple consecutive Network Connections between a Client and a Server.</p>

<p><strong>MQTT Control Packet</strong>: A packet of information that is sent across the Network Connection. The MQTT specification defines fourteen different types of Control Packet, one of which (the PUBLISH packet) is used to convey Application Messages.</p>

<h1 id="toc_4">Architecture</h1>

<p>Architectures follow different design patterns, some are REST-oriented with clear methods to find and manipulate resources on endpoints with almost no state kept between them. Others are more Publish/Subscribe-oriented that focus on the flow of information based on the topics of the information being shared. Others are RPC-like requiring to know beforehand the set of parameters that are accessed, they require to generate code both on the client and server side, they are tightly coupled and service-oriented.</p>

<ul>
<li>Thing-hub-cloud --things talk to a hub, which talks back to them and to the cloud. There’s a spectrum of emphasis on the hub vs. the cloud. In some the hub is simply an access point; in others it’s a critical place for control loops and ALGs.</li>
<li>Meta Thing--some things are actually virtual, like an alarm composed of clock, lights, and thermostat.</li>
<li>Nearby things--some things may be geospatially related even if they are not on the same network or within the same administrative domain.</li>
</ul>

<p>Current data models and definitions for <q>things</q> often focus on defining actual physical devices and representing their state. That focus should perhaps be shifted into a more holistic or user-oriented perspective, defining abstract concepts as well. On the other a lot of focus is placed on human interaction with physical devices while IoT will be more oriented to interaction between <q>things</q> instead.<br>
Those things should be designed to be multiple-purpose, keeping in mind that solutions should be open-ended to facilitate new usages and new future domains of operation. this pattern has already happened, devices that were intended for one purpose end up being used for a different one given the right context ((e.g. smart phone led light turned out to be a heartrate monitor).</p>

<p>IoT domain is currently missing insights into what users actually expect. </p>

<h1 id="toc_5">Device Management for MQTT</h1>

<p>IBM&#39;s IoT Foundation is looking into managed devices that use LWM2M [MQTT-DM].</p>

<blockquote>
<p>The Device Management Protocol defines a set of supported operations. A device management agent can support a subset of the operations, but managed and unmanaged device operations must be supported. A device supporting firmware action operations must also support observation.</p>
</blockquote>

<p>In their scenario, Lifecycle Management comprises the following operations:</p>

<h1 id="toc_6">Publish-Subscribe Broker for CoAP</h1>

<p>Due to the demand on some industries and the relative success of simple publish/subscriber brokers such as MQTT, some effort has been dedicated by the IETF CoRE WG on defining a publish-subscribe broker for CoAP that extends the capabilities of CoAP for supporting nodes with long breaks in connectivity. That is, the CoAP PubSub broker [I-D.koster-core-coap-pubsub]. </p>

<p>This broker is a CoAP Server that exposes an interface for clients to use to initiate publish-subscribe interactions. The architecture it provides is similar as MQTT with, broker, clients and topics. </p>

<div><pre><code class="language-c">                  Clients        pub/sub         Broker
                  +-------+         |
                  | CoAP  |         |
                  |pub/sub|---------|------+
                  |Client |         |      |    +-------+
                  +-------+         |      +----| CoAP  |
                                    |           |pub/sub|
                  +-------+         |      +----|Broker |
                  | CoAP  |         |      |    +-------+
                  |pub/sub|---------|------+
                  |Client |         |
                  +-------+         |</code></pre></div>

<p><em>CoAP pub/sub Architecture.</em> </p>

<p>Among the novelties, it makes use of CoAP&#39;s discovery mechanism, it uses the Resource Directory (RD) <a href="https://tools.ietf.org/html/draft-ietf-core-resource-directory-07">[I-D.ietf-core-resource-directory]</a> as discovery interface. This means that a broker offering the publish/subscribe functionality will register on the RD and will use the link relation <code>rt=&quot;core.ps&quot;</code>.</p>

<p>The process for a client that wants to make use of the broker has two steps:</p>

<ol>
<li><p>Discover the PS functionality. </p>

<p><code>GET /.well-known/core?rt=core.ps</code></p></li>
<li><p>Discover topics.</p>

<p><code>GET /ps/?rt=&quot;my topic</code></p></li>
</ol>

<p>Once DISCOVERY is completed, the device can continue using the rest of the pub/sub function set: CREATE, PUBLISH, SUBSCRIBE, UNSUBSCRIBE, READ, REMOVE. For details on those operations please use Section 4 of [I-D.koster-core-coap-pubsub]. </p>

<p>The broker has a simple way to control the flow of messages. Since it might have to notify too many observers at some point, if it can not serve the request, the client would get a 4.29 <q>Too Many Requests</q> message. </p>

<p>Additionally, depending on the level of trust, endpoints can place some trust on the broker to perform other operations (e.g. caching, filtering, ordering...), this can be done with some degree of security by using OSCON <a href="https://tools.ietf.org/html/draft-selander-ace-object-security-04">[I-D.selander-ace-object-security]</a></p>

<h1 id="toc_7">Examples</h1>

<p>Without trying to be exhaustive, </p>

<div><pre><code class="language-c">CLIENT                                                     SERVER
  |                                                            |
  | CON [MID=1234], GET, /status                       ------&gt; |
  |                                                            |
  | &lt;------   ACK [MID=1234], 2.05 Content, 2/0/1/128          |
  |                                                            |
  | CON [MID=1235], GET, /status, 2/1/0/128            ------&gt; |
  |                                                            |
  | &lt;------   ACK [MID=1235], 2.05 Content, 2/1/1/128          |
  |                                                            |
  | CON [MID=1236], GET, /status, 2/2/0/128            ------&gt; |
  |                                                            |
  | &lt;------   ACK [MID=1236], 2.05 Content, 2/2/0/128          |</code></pre></div>

<p><em>Simple blockwise GET operation</em></p>

<h1 id="toc_8">Tests</h1>

<p>The MQTT Javascript Library [MQTTJS] has been used to run several tests on MQTT. The following is an example with both client and subscriber:</p>

<div><pre><code class="language-javascript">var mqtt    = require(&#39;mqtt&#39;);
var client  = mqtt.connect(&#39;mqtt://test.mosquitto.org&#39;);
 
client.on(&#39;connect&#39;, function () {
  client.subscribe(&#39;presence&#39;);
  client.publish(&#39;presence&#39;, &#39;Testing MQTT&#39;);
});
 
client.on(&#39;message&#39;, function (topic, message) {
  // message is Buffer 
  console.log(message.toString());
  client.end();
});</code></pre></div>

<p>We used the command-line tool: <code>npm install mqtt -g</code></p>

<div><pre><code class="language-bash">
term&gt; tcpdump -qns 0 -X -r dump2.pcap 
tcpdump -qns 0 -A -r dump2.pcap 

mqtt sub -t &#39;TOPIC&#39; -h &#39;test.mosquitto.org&#39; -v
mqtt pub -t &#39;TOPIC&#39; -h &#39;test.mosquitto.org&#39; -m &#39;PUBLICATION&#39;

tcptrace -G dump2.pcap

1: 10.0.0.200:49269 - bf.ral.me:1883 (a2b)   15&gt;    9&lt;  (complete)
2: 10.0.0.200:49270 - bf.ral.me:1883 (c2d)    8&gt;    5&lt;  (complete)
3: 10.0.0.200:49271 - bf.ral.me:1883 (e2f)    8&gt;    5&lt;  (complete)
4: 10.0.0.200:49273 - bf.ral.me:1883 (g2h)    8&gt;    5&lt;  (complete)
</code></pre></div>

<p>If you already have CoAP, the easiest way is probably do a mapping EP IDs to Topic (req and response). Encapsulate CoAP messages in MQTT and use MQTT as transport. </p>

<p>MQTT subscribe map to observe and notify. CoAP link that I can use as topic. Hyperlink = MQTT topics  (for subscribing and publishing). location on RD = Topic in Broker. No query parameters are possible though.</p>

<p>Check this: </p>

<p>https://github.com/sathipal/lwm2m<u>over</u>mqtt</p>

<h1 id="toc_9">Acknowledgements</h1>

<p>The authors would like to thank Simen Kid, Hannes Tschofenig, Michael Koster. </p>

<h1 id="toc_10">References</h1>

<ul>
<li><a href="https://tools.ietf.org/html/draft-koster-core-coap-pubsub-04">I-D.koster-core-coap-pubsub</a> - Publish-Subscribe Broker for the Constrained Application Protocol (CoAP).</li>
<li><a href="https://tools.ietf.org/html/draft-ietf-core-resource-directory-07">I-D.ietf-core-resource-directory</a> - CoRE Resource Directory.</li>
<li><a href="https://tools.ietf.org/html/draft-selander-ace-object-security-04">I-D.selander-ace-object-security</a> - Object Security of CoAP (OSCOAP).</li>
<li><a href="https://tools.ietf.org/html/rfc7252">RFC7252</a> - The Constrained Application Protocol (CoAP).</li>
<li><a href="https://tools.ietf.org/html/rfc6455">RFC6455</a> - The WebSocket Protocol.</li>
<li><a href="https://tools.ietf.org/html/rfc5246">RFC5246</a> - The Transport Layer Security (TLS) Protocol.</li>
<li><a href="https://www.ics.uci.edu/%7Efielding/pubs/dissertation/top.htm">REST</a> - Architectural Styles and the Design of Network-based Software Architectures.</li>
<li><a href="https://docs.internetofthings.ibmcloud.com/devices/device_mgmt/index.html">MQTTDM</a> - Device Management Protocol for MQTT.</li>
<li><a href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html">MQTT</a> - MQ Telemetry Transport (mqtt) v3.1.1 protocol specification.</li>
<li><a href="https://www.npmjs.com/package/mqtt">MQTTJS</a> - A library for the MQTT protocol</li>
<li><a href="https://github.com/lwmqn">LWMQN</a> - Lightweight MQTT Machine Network</li>
</ul>



<script type="text/javascript">
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var l=r[e];if(2==arguments.length){a=arguments[1];for(var i in a)a.hasOwnProperty(i)&&(l[i]=a[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],a||l),"Object"!==n.util.type(e[l])||r[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||r[n.util.objId(e[l])]||(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,r)):(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,l=a.elements||document.querySelectorAll(a.selector),i=0;r=l[i++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1],i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l);var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(!s||!i)return n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var l=n.tokenize(e,t);return a.stringify(n.util.encode(l),r)},tokenize:function(e,t){var a=n.Token,r=[e],l=t.rest;if(l){for(var i in l)t[i]=l[i];delete t.rest}e:for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=t[i];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],c=u.inside,g=!!u.lookbehind,h=!!u.greedy,f=0,d=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var m=r[p];if(r.length>e.length)break e;if(!(m instanceof a)){u.lastIndex=0;var y=u.exec(m),v=1;if(!y&&h&&p!=r.length-1){var b=r[p+1].matchedStr||r[p+1],k=m+b;if(p<r.length-2&&(k+=r[p+2].matchedStr||r[p+2]),u.lastIndex=0,y=u.exec(k),!y)continue;var w=y.index+(g?y[1].length:0);if(w>=m.length)continue;var _=y.index+y[0].length,P=m.length+b.length;if(v=3,P>=_){if(r[p+1].greedy)continue;v=2,k=k.slice(0,P)}m=k}if(y){g&&(f=y[1].length);var w=y.index+f,y=y[0].slice(f),_=w+y.length,S=m.slice(0,w),O=m.slice(_),j=[p,v];S&&j.push(S);var A=new a(i,c?n.tokenize(y,c):y,d,y,h);j.push(A),O&&j.push(O),Array.prototype.splice.apply(r,j)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,l=0;r=a[l++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.matchedStr=a||null,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var l={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==l.type&&(l.attributes.spellcheck="true"),e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o="";for(var s in l.attributes)o+=(o?" ":"")+s+'="'+(l.attributes[s]||"")+'"';return"<"+l.tag+' class="'+l.classes.join(" ")+'" '+o+">"+l.content+"</"+l.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,l=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),l&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",n.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
</script>

<script type="text/javascript">
!function(e){var t={variable:[{pattern:/\$?\(\([\w\W]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\w\W]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b-?(?:0x[\dA-Fa-f]+|\d*\.?\d+(?:[Ee]-?\d+)?)\b/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[a-z0-9_#\?\*!@]+|\{[^}]+\})/i]};e.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:"important"},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^<])<<\s*)(?:"|')?(\w+?)(?:"|')?\s*\r?\n(?:[\s\S])*?\r?\n\2/g,lookbehind:!0,inside:t},{pattern:/(["'])(?:\\\\|\\?[^\\])*?\1/g,inside:t}],variable:t.variable,"function":{pattern:/(^|\s|;|\||&)(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|\s|;|\||&)/,lookbehind:!0},keyword:{pattern:/(^|\s|;|\||&)(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|\s|;|\||&)/,lookbehind:!0},"boolean":{pattern:/(^|\s|;|\||&)(?:true|false)(?=$|\s|;|\||&)/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|<<<?|>>|<=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var a=t.variable[1].inside;a["function"]=e.languages.bash["function"],a.keyword=e.languages.bash.keyword,a.boolean=e.languages.bash.boolean,a.operator=e.languages.bash.operator,a.punctuation=e.languages.bash.punctuation}(Prism);
</script>

<script type="text/javascript">
Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/};
</script>

<script type="text/javascript">
Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,"function":/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),Prism.languages.insertBefore("javascript","class-name",{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:Prism.languages.javascript,alias:"language-javascript"}}),Prism.languages.js=Prism.languages.javascript;
</script>

<script type="text/javascript">
Prism.languages.c=Prism.languages.extend("clike",{keyword:/\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/,operator:/\-[>-]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|?\||[~^%?*\/]/,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)[ful]*\b/i}),Prism.languages.insertBefore("c","string",{macro:{pattern:/(^\s*)#\s*[a-z]+([^\r\n\\]|\\.|\\(?:\r\n?|\n))*/im,lookbehind:!0,alias:"property",inside:{string:{pattern:/(#\s*include\s*)(<.+?>|("|')(\\?.)+?\3)/,lookbehind:!0},directive:{pattern:/(#\s*)\b(define|elif|else|endif|error|ifdef|ifndef|if|import|include|line|pragma|undef|using)\b/,lookbehind:!0,alias:"keyword"}}},constant:/\b(__FILE__|__LINE__|__DATE__|__TIME__|__TIMESTAMP__|__func__|EOF|NULL|stdin|stdout|stderr)\b/}),delete Prism.languages.c["class-name"],delete Prism.languages.c["boolean"];
</script>


</body>

</html>
